<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/" lang="en">
<head th:replace="fragments/header :: header"></head>
<body>

<nav th:replace="fragments/navbar :: navbar"></nav>
<table th:if="${order != null}" class="table table-bordered">

    <tr style="font-weight: bold">
        <td th:if="${order != null}" th:text="'Id'"></td>
        <td th:if="${order != null}" th:text="'Data załadunku'"></td>
        <td th:if="${order != null}" th:text="'Nr tury'"></td>
        <td th:if="${order != null}" th:text="'Załadunek'"></td>
        <td th:if="${order != null}" th:text="'Rozładunki'"></td>
        <td th:if="${order != null}" th:text="'Cena nasza'"></td>
        <td th:if="${order != null}" th:text="'Cena przewoźnika'"></td>
        <td th:if="${order != null}" th:text="'Przewoźnik'"></td>
        <td th:if="${order != null}" th:text="'T/S'"></td>

    </tr>

    <tr>
        <td><span th:text="${order.id}"></span></td>
        <td><span th:text="${order.loadDate}"></span></td>
        <td><span th:text="${order.orderNumber}"></span></td>
        <td><span th:if="${order.factory!=null}"
                  th:text="${order.getFactory().factoryCity}+' ('+${order.getFactory().factoryName}+')'"></span></td>
        <td>  <span th:each="code,iterStat : ${order.codes}">
            <span th:text="${code.cityCode}"/><th:block th:if="${!iterStat.last}">, </th:block></span></td>
        <td><span th:text="${order.price}"></span></td>
        <td><span th:text="${order.freighterPrice}"></span></td>
        <td><span th:if="${order.freighter!=null}" th:text="${order.getFreighter().freighterName}"></span></td>
        <td><span th:if="${order.user!=null}" th:text="${order.getUser().userName}"></span></td>

    </tr>

</table>


<!--formularz start-->
<div class="container-fluid" style="background-color: lightgrey">
    <div style="padding-top: 25px;padding-bottom: 25px">
        <p style="font-weight: bold">EDYTUJ:</p>
        <form method="post" th:action="@{/edit/{id}(id=${order.id})}" th:object="${order}">
            <div class="form-group row">
                <label for="inputEmail3" class="col-sm-2 col-form-label">NR TURY</label>
                <div class="col-sm-2">
                    <input class="form-control" id="inputEmail3" name="orderNumber" type="number"
                           th:value="${order.getOrderNumber()}">
                </div>
            </div>
            <div class="form-group row">
                <label for="inputEmail4" class="col-sm-2 col-form-label">DATA ZAŁADUNKU</label>
                <div class="col-sm-2">
                    <input name="loadDate" type="date" th:value="${order.getLoadDate()}" class="form-control"
                           id="inputEmail4">
                </div>
            </div>
            <!--ZAŁADUNKU NIE EDYTUJE SIĘ-->
            <!-- <div class="form-group row">
                 <label for="inputEmail44" class="col-sm-2 col-form-label">ZAŁADUNEK</label>
                 <div class="col-sm-2" th:object="${factories}">
                     <select name="factory" class="form-control" id="inputEmail44">
                         <option value="" selected>Wybierz miasto...</option>
                         <option th:each="f : ${factories}" th:value="${f.id}" th:text="${f.factoryCity}"></option>
                     </select>

                 </div>
             </div>-->

            <div class="form-group row">
                <label for="inputEmail5" class="col-sm-2 col-form-label">ROZŁADUNKI:</label>
                <div class="col-sm-2">
                    <div th:each="k : ${order.codes}">
                        <div>
                            <input name="cityCode" type="text" class="form-control" th:value="${k.cityCode}"/>
                        </div>
                    </div>
                    <div th:if="${order.codes.isEmpty()}">
                        <div>
                            <textarea placeholder="Wpisz kody rozładunków odzdzielone przecinkami..." name="cityCode"
                                      class="form-control"
                                      id="validationTextarea" rows="5"></textarea>
                        </div>
                    </div>
                </div>
            </div>


            <div class="form-group row">
                <label for="inputEmail5" class="col-sm-2 col-form-label">CENA NASZA</label>
                <div class="col-sm-2">
                    <input name="price" th:value="${order.getPrice()}" type="number" step="0.01" class="form-control"
                           id="inputEmail5">
                </div>
            </div>
            <div class="form-group row">
                <label for="inputEmail6" class="col-sm-2 col-form-label">CENA PRZEWOŹNIKA</label>
                <div class="col-sm-2">
                    <input name="freighterPrice" th:value="${order.getFreighterPrice()}" type="number" step="0.01"
                           class="form-control" id="inputEmail6">
                </div>
            </div>
            <div class="form-group row">
                <label for="exampleFormControlSelect2" class="col-sm-2 col-form-label">PRZEWOŹNIK</label>
                <div class="col-sm-2" th:object="${freighters}">
                    <select name="freighter" class="form-control" id="exampleFormControlSelect2">
                        <!--  <select id="freighter" name="freighter" class="form-control">-->
                        <option value=" ">Wybierz przewoźnika:</option>
                        <option th:if="${order.getFreighter()}!=null" th:each="f : ${freighters}" th:value="${f.id}"
                                th:text="${f.freighterName}" th:selected="${f.id== order.getFreighter().id}"></option>
                        <option th:if="${order.freighter}==null" th:each="f : ${freighters}" th:value="${f.id}"
                                th:text="${f.freighterName}"></option>
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label for="exampleFormControlSelect1" class="col-sm-2 col-form-label">T/S</label>
                <div class="col-sm-2" th:object="${users}">
                    <select name="user" class="form-control" id="exampleFormControlSelect1">
                        <option value=" ">Wybierz osobę:</option>
                        <option th:if="${order.user}!=null" th:each="u : ${users}" th:value="${u.id}"
                                th:text="${u.userName}" th:selected="${u.id == order.getUser().id}"></option>
                        <option th:if="${order.user}==null" th:each="u : ${users}" th:value="${u.id}"
                                th:text="${u.userName}"></option>
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-2">

                </div>
                <div class="col-sm-2">
                    <button type="submit" class="btn btn-success">ZAPISZ</button>
                    <a href="/orders" class="btn btn-danger">ANULUJ</a>
                </div>
            </div>
        </form>
        <!--formularz end-->
    </div>
</div>
</body>
</html>